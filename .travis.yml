language: java
jdk:
  - openjdk8
 
before_install:
  - echo $ENC_GPG_KEY | base64 --decode | gpg --fast-import
  - gpg --list-keys

jobs:
  include:
    - stage: pr
      script: "mvn clean deploy"
      if: $TRAVIS_PULL_REQUEST" == 'true'
    - stage: ci
      script: "mvn clean deploy -s settings.xml -Dmaven.test.skip=true -B -P deploy"
      if: $TRAVIS_PULL_REQUEST" == 'false' AND branch = master AND $TRAVIS_TAG != "tag-new-release"
    - stage: release
      script: "mvn clean release:clean release:prepare release:perform -s settings.xml -Dmaven.test.skip=true -B -P deploy"
      if: $TRAVIS_PULL_REQUEST" == 'false' AND branch = master AND $TRAVIS_TAG == "tag-new-release"

